<?xml version="1.0" encoding="utf-8"?>
<BugCollection sequence='0' release='' analysisTimestamp='1686907908787' version='4.7.3' timestamp='1686907832470'><Project projectName='Sesion05pfs341'><Jar>C:\Users\perid\git\Practica05\Sesion05pfs341\target\classes</Jar><AuxClasspathEntry>C:\Users\perid\.m2\repository\com\google\code\gson\gson\2.10.1\gson-2.10.1.jar</AuxClasspathEntry><AuxClasspathEntry>C:\Users\perid\.m2\repository\nl\talsmasoftware\umldoclet\2.1.0\umldoclet-2.1.0.jar</AuxClasspathEntry><Plugin id='com.h3xstream.findsecbugs' enabled='true'></Plugin><SrcDir>C:\Users\perid\git\Practica05\Sesion05pfs341\src</SrcDir><WrkDir>C:\Users\perid\git\Practica05\Sesion05pfs341\target</WrkDir></Project><BugInstance instanceOccurrenceNum='0' instanceHash='4ad6f3b8d2c4cf0d62b585c0f0850b62' cweid='22' rank='15' abbrev='SECPTI' category='SECURITY' priority='3' type='PATH_TRAVERSAL_IN' instanceOccurrenceMax='0'><ShortMessage>Potential Path Traversal (file read)</ShortMessage><LongMessage>This API (java/io/FileReader.&lt;init&gt;(Ljava/lang/String;)V) reads a file whose location might be specified by user input</LongMessage><Class classname='ual.hmis.sesion05.coches.JsonReader' primary='true'><SourceLine classname='ual.hmis.sesion05.coches.JsonReader' start='12' end='35' sourcepath='ual/hmis/sesion05/coches/JsonReader.java' sourcefile='JsonReader.java'><Message>At JsonReader.java:[lines 12-35]</Message></SourceLine><Message>In class ual.hmis.sesion05.coches.JsonReader</Message></Class><Method isStatic='true' classname='ual.hmis.sesion05.coches.JsonReader' signature='(Ljava/lang/String;)[Lual/hmis/sesion05/coches/Coche;' name='leerCochesJSON' primary='true'><SourceLine endBytecode='404' classname='ual.hmis.sesion05.coches.JsonReader' start='16' end='35' sourcepath='ual/hmis/sesion05/coches/JsonReader.java' sourcefile='JsonReader.java' startBytecode='0'></SourceLine><Message>In method ual.hmis.sesion05.coches.JsonReader.leerCochesJSON(String)</Message></Method><SourceLine endBytecode='55' classname='ual.hmis.sesion05.coches.JsonReader' start='21' end='21' sourcepath='ual/hmis/sesion05/coches/JsonReader.java' sourcefile='JsonReader.java' startBytecode='55' primary='true'><Message>At JsonReader.java:[line 21]</Message></SourceLine><String role='Sink method' value='java/io/FileReader.&lt;init&gt;(Ljava/lang/String;)V'><Message>Sink method java/io/FileReader.&lt;init&gt;(Ljava/lang/String;)V</Message></String><String role='Sink parameter' value='0'><Message>Sink parameter 0</Message></String><String role='Unknown source' value='ual/hmis/sesion05/coches/JsonReader.leerCochesJSON(Ljava/lang/String;)[Lual/hmis/sesion05/coches/Coche; parameter 0'><Message>Unknown source ual/hmis/sesion05/coches/JsonReader.leerCochesJSON(Ljava/lang/String;)[Lual/hmis/sesion05/coches/Coche; parameter 0</Message></String><String role='Method usage' value='detected only with safe arguments'><Message>Method usage detected only with safe arguments</Message></String><SourceLine endBytecode='44' classname='ual.hmis.sesion05.coches.JsonReader' start='21' end='21' sourcepath='ual/hmis/sesion05/coches/JsonReader.java' sourcefile='JsonReader.java' startBytecode='44'><Message>At JsonReader.java:[line 21]</Message></SourceLine></BugInstance><BugCategory category='SECURITY'><Description>Security</Description></BugCategory><BugPattern cweid='22' abbrev='SECPTI' category='SECURITY' type='PATH_TRAVERSAL_IN'><ShortDescription>Potential Path Traversal (file read)</ShortDescription><Details>
            
&lt;p&gt;A file is opened to read its content. The filename comes from an &lt;b&gt;input&lt;/b&gt; parameter.
If an unfiltered parameter is passed to this file API, files from an arbitrary filesystem location could be read.&lt;/p&gt;
&lt;p&gt;This rule identifies &lt;b&gt;potential&lt;/b&gt; path traversal vulnerabilities. In many cases, the constructed file path cannot be controlled
by the user. If that is the case, the reported instance is a false positive.&lt;/p&gt;
&lt;br/&gt;

&lt;p&gt;
    &lt;b&gt;Vulnerable Code:&lt;/b&gt;&lt;br/&gt;
&lt;pre&gt;@GET
@Path("/images/{image}")
@Produces("images/*")
public Response getImage(@javax.ws.rs.PathParam("image") String image) {
    File file = new File("resources/images/", image); //Weak point

    if (!file.exists()) {
        return Response.status(Status.NOT_FOUND).build();
    }

    return Response.ok().entity(new FileInputStream(file)).build();
}&lt;/pre&gt;
&lt;/p&gt;
&lt;br/&gt;

&lt;p&gt;
    &lt;b&gt;Solution:&lt;/b&gt;&lt;br/&gt;
&lt;pre&gt;import org.apache.commons.io.FilenameUtils;

@GET
@Path("/images/{image}")
@Produces("images/*")
public Response getImage(@javax.ws.rs.PathParam("image") String image) {
    File file = new File("resources/images/", FilenameUtils.getName(image)); //Fix

    if (!file.exists()) {
        return Response.status(Status.NOT_FOUND).build();
    }

    return Response.ok().entity(new FileInputStream(file)).build();
}&lt;/pre&gt;
&lt;/p&gt;
&lt;br/&gt;
&lt;p&gt;
&lt;b&gt;References&lt;/b&gt;&lt;br/&gt;
&lt;a href="http://projects.webappsec.org/w/page/13246952/Path%20Traversal"&gt;WASC: Path Traversal&lt;/a&gt;&lt;br/&gt;
&lt;a href="https://www.owasp.org/index.php/Path_Traversal"&gt;OWASP: Path Traversal&lt;/a&gt;&lt;br/&gt;
&lt;a href="https://capec.mitre.org/data/definitions/126.html"&gt;CAPEC-126: Path Traversal&lt;/a&gt;&lt;br/&gt;
&lt;a href="https://cwe.mitre.org/data/definitions/22.html"&gt;CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')&lt;/a&gt;
&lt;/p&gt;

        </Details></BugPattern><BugCode abbrev='SECPTI'><Description>Potential Path Traversal (file read)</Description></BugCode><Errors missingClasses='0' errors='0'></Errors><FindBugsSummary num_packages='6' total_classes='8' priority_3='1' total_size='134' clock_seconds='2.86' referenced_classes='38' vm_version='19.0.2+7-44' total_bugs='1' java_version='19.0.2' gc_seconds='0.01' alloc_mbytes='512.00' cpu_seconds='2.06' peak_mbytes='204.16' timestamp='Fri, 16 Jun 2023 11:30:32 +0200'><FileStats path='ual/hmis/sesion05/Ejercicio1.java' size='13' bugCount='0'></FileStats><FileStats path='ual/hmis/sesion05/coches/Coche.java' size='50' bugCount='0'></FileStats><FileStats path='ual/hmis/sesion05/coches/JsonReader.java' size='14' bugHash='0cb6d228da452b0b4aced965694e1fc2' bugCount='1'></FileStats><FileStats path='ual/hmis/sesion05/coches/Main.java' size='9' bugCount='0'></FileStats><FileStats path='ual/hmis/sesion05/ejercicio2/Ejercicio2.java' size='14' bugCount='0'></FileStats><FileStats path='ual/hmis/sesion05/ejercicio3/Ejercicio3.java' size='8' bugCount='0'></FileStats><FileStats path='ual/hmis/sesion05/ejercicio4/Ejercicio4.java' size='17' bugCount='0'></FileStats><FileStats path='ual/hmis/sesion05/ejercicio5/Ejercicio5.java' size='9' bugCount='0'></FileStats><PackageStats package='ual.hmis.sesion05' total_bugs='0' total_size='13' total_types='1'><ClassStats bugs='0' size='13' interface='false' sourceFile='Ejercicio1.java' class='ual.hmis.sesion05.Ejercicio1'></ClassStats></PackageStats><PackageStats package='ual.hmis.sesion05.coches' total_bugs='1' priority_3='1' total_size='73' total_types='3'><ClassStats bugs='0' size='50' interface='false' sourceFile='Coche.java' class='ual.hmis.sesion05.coches.Coche'></ClassStats><ClassStats bugs='1' size='14' priority_3='1' interface='false' sourceFile='JsonReader.java' class='ual.hmis.sesion05.coches.JsonReader'></ClassStats><ClassStats bugs='0' size='9' interface='false' sourceFile='Main.java' class='ual.hmis.sesion05.coches.Main'></ClassStats></PackageStats><PackageStats package='ual.hmis.sesion05.ejercicio2' total_bugs='0' total_size='14' total_types='1'><ClassStats bugs='0' size='14' interface='false' sourceFile='Ejercicio2.java' class='ual.hmis.sesion05.ejercicio2.Ejercicio2'></ClassStats></PackageStats><PackageStats package='ual.hmis.sesion05.ejercicio3' total_bugs='0' total_size='8' total_types='1'><ClassStats bugs='0' size='8' interface='false' sourceFile='Ejercicio3.java' class='ual.hmis.sesion05.ejercicio3.Ejercicio3'></ClassStats></PackageStats><PackageStats package='ual.hmis.sesion05.ejercicio4' total_bugs='0' total_size='17' total_types='1'><ClassStats bugs='0' size='17' interface='false' sourceFile='Ejercicio4.java' class='ual.hmis.sesion05.ejercicio4.Ejercicio4'></ClassStats></PackageStats><PackageStats package='ual.hmis.sesion05.ejercicio5' total_bugs='0' total_size='9' total_types='1'><ClassStats bugs='0' size='9' interface='false' sourceFile='Ejercicio5.java' class='ual.hmis.sesion05.ejercicio5.Ejercicio5'></ClassStats></PackageStats><FindBugsProfile><ClassProfile avgMicrosecondsPerInvocation='736' totalMilliseconds='409' name='edu.umd.cs.findbugs.classfile.engine.ClassInfoAnalysisEngine' maxMicrosecondsPerInvocation='25557' standardDeviationMicrosecondsPerInvocation='1766' invocations='556'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='192' totalMilliseconds='107' name='edu.umd.cs.findbugs.classfile.engine.ClassDataAnalysisEngine' maxMicrosecondsPerInvocation='5026' standardDeviationMicrosecondsPerInvocation='267' invocations='558'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='2478' totalMilliseconds='94' name='edu.umd.cs.findbugs.detect.FieldItemSummary' maxMicrosecondsPerInvocation='19533' standardDeviationMicrosecondsPerInvocation='4136' invocations='38'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='2251' totalMilliseconds='65' name='edu.umd.cs.findbugs.classfile.engine.bcel.MethodGenFactory' maxMicrosecondsPerInvocation='54592' standardDeviationMicrosecondsPerInvocation='9917' invocations='29'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='734' totalMilliseconds='64' name='edu.umd.cs.findbugs.classfile.engine.bcel.JavaClassAnalysisEngine' maxMicrosecondsPerInvocation='40505' standardDeviationMicrosecondsPerInvocation='4317' invocations='88'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='453' totalMilliseconds='58' name='edu.umd.cs.findbugs.OpcodeStack$JumpInfoFactory' maxMicrosecondsPerInvocation='5014' standardDeviationMicrosecondsPerInvocation='628' invocations='129'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='1490' totalMilliseconds='56' name='edu.umd.cs.findbugs.detect.FindNoSideEffectMethods' maxMicrosecondsPerInvocation='10112' standardDeviationMicrosecondsPerInvocation='2080' invocations='38'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='77' totalMilliseconds='40' name='edu.umd.cs.findbugs.util.TopologicalSort' maxMicrosecondsPerInvocation='1234' standardDeviationMicrosecondsPerInvocation='145' invocations='522'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='1333' totalMilliseconds='38' name='com.h3xstream.findsecbugs.taintanalysis.TaintDataflowEngine' maxMicrosecondsPerInvocation='18323' standardDeviationMicrosecondsPerInvocation='3381' invocations='29'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='1010' totalMilliseconds='38' name='edu.umd.cs.findbugs.detect.NoteDirectlyRelevantTypeQualifiers' maxMicrosecondsPerInvocation='13932' standardDeviationMicrosecondsPerInvocation='2307' invocations='38'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='1140' totalMilliseconds='34' name='edu.umd.cs.findbugs.classfile.engine.bcel.ValueNumberDataflowFactory' maxMicrosecondsPerInvocation='17751' standardDeviationMicrosecondsPerInvocation='3138' invocations='30'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='1045' totalMilliseconds='30' name='edu.umd.cs.findbugs.classfile.engine.bcel.IsNullValueDataflowFactory' maxMicrosecondsPerInvocation='10924' standardDeviationMicrosecondsPerInvocation='2157' invocations='29'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='1013' totalMilliseconds='29' name='edu.umd.cs.findbugs.classfile.engine.bcel.CFGFactory' maxMicrosecondsPerInvocation='18617' standardDeviationMicrosecondsPerInvocation='3354' invocations='29'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='771' totalMilliseconds='29' name='edu.umd.cs.findbugs.detect.FunctionsThatMightBeMistakenForProcedures' maxMicrosecondsPerInvocation='8923' standardDeviationMicrosecondsPerInvocation='1744' invocations='38'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='954' totalMilliseconds='28' name='edu.umd.cs.findbugs.classfile.engine.bcel.TypeDataflowFactory' maxMicrosecondsPerInvocation='9857' standardDeviationMicrosecondsPerInvocation='1841' invocations='30'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='3574' totalMilliseconds='28' name='edu.umd.cs.findbugs.detect.FindDeadLocalStores' maxMicrosecondsPerInvocation='23025' standardDeviationMicrosecondsPerInvocation='7429' invocations='8'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='673' totalMilliseconds='25' name='edu.umd.cs.findbugs.detect.OverridingEqualsNotSymmetrical' maxMicrosecondsPerInvocation='13431' standardDeviationMicrosecondsPerInvocation='2152' invocations='38'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='815' totalMilliseconds='23' name='edu.umd.cs.findbugs.ba.npe.NullDerefAndRedundantComparisonFinder' maxMicrosecondsPerInvocation='5005' standardDeviationMicrosecondsPerInvocation='1155' invocations='29'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='790' totalMilliseconds='22' name='edu.umd.cs.findbugs.classfile.engine.bcel.UnconditionalValueDerefDataflowFactory' maxMicrosecondsPerInvocation='4924' standardDeviationMicrosecondsPerInvocation='1267' invocations='29'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='553' totalMilliseconds='21' name='edu.umd.cs.findbugs.detect.BuildStringPassthruGraph' maxMicrosecondsPerInvocation='6602' standardDeviationMicrosecondsPerInvocation='1214' invocations='38'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='480' totalMilliseconds='18' name='edu.umd.cs.findbugs.detect.BuildObligationPolicyDatabase' maxMicrosecondsPerInvocation='3082' standardDeviationMicrosecondsPerInvocation='669' invocations='38'></ClassProfile></FindBugsProfile></FindBugsSummary><ClassFeatures></ClassFeatures><History></History></BugCollection>